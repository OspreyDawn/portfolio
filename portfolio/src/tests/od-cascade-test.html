<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/neon-animation/neon-animation.html">
<link rel="import" href="../bower_components/neon-animation/neon-animations.html">

<dom-module id="od-cascade-test">
  <template>
    <style>

      p {
        margin: 0.5rem 0;
      }

      button {
        margin: 0.5rem 0.5rem;
      }

      .neonControl {
        @apply(--layout-vertical);
        @apply(--layout-flex);
        @apply(--layout-center);
      }

      .titleContainer {
        @apply(--layout-horizontal);
      }

      .titleContainer > p {
        color: black;
        font-weight: bold;
        font-size: 1rem;
        margin-bottom: 0;
      }

      .buttonContainer {
        @apply(--layout-horizontal);
      }

      .neonContainer {
        background: #EEE;
        @apply(--layout-fullbleed);
        @apply(--layout-vertical);
        @apply(--layout-center-center);
      }

      #entry-type {
        /* padding-right: 1rem; */
      }

      #exit-type {
        padding-left: 1rem;
      }

      .neonElement {
        background: blue;
        padding: 1rem 2rem;
        margin-bottom: 1rem;
        text-align: center;
        border-radius: 5px;
        display: none;
      }

      .neonContainer[visible] > .neonElement {
        display: block;
      }

    </style>

      <div class="neonControl">
        <div class="titleContainer">
          <p id="entry-type">Cascade Animation Test</p><!-- <p>|</p><p id="exit-type">Exit Animation Name</p> -->
        </div>
        <div class="buttonContainer">
          <button on-click="neonPlay">[[neonState]]</button>
        </div>
      </div>

      <div visible$="{{isVisible}}" class="neonContainer">
        <div id="neonStart" class="neonElement"></div>
        <div class="neonElement"></div>
        <div class="neonElement"></div>
        <div id="neonStop" class="neonElement"></div>
      </div>

  </template>

  <script>
    Polymer({

      is: 'od-cascade-test',

      behaviors: [
        Polymer.NeonAnimationRunnerBehavior
      ],

      properties: {

        isVisible: {
          type: Boolean,
          value: false
        },

        entered: {
          type: Boolean
        },

        neonState: {
          type: String,
          value: 'Enter'
        },

        animationConfig: {
          value: function() {
            return {

              'enter':
                [{
                  name: 'cascaded-animation',
                  animation: 'fade-in-animation',
                  nodes: Polymer.dom(this.root).querySelectorAll('.neonElement'),
                  nodeDelay: 100,
                  timing: { delay: 0 }
                },
                {
                  name: 'cascaded-animation',
                  animation: 'slide-from-right-animation',
                  nodes: Polymer.dom(this.root).querySelectorAll('.neonElement'),
                  nodeDelay: 100,
                  timing: { delay: 0 }
                }],

              'exit':
                [{
                  name: 'cascaded-animation',
                  animation: 'fade-out-animation',
                  nodes: Polymer.dom(this.root).querySelectorAll('.neonElement').reverse(),
                  nodeDelay: 100,
                  timing: { delay: 0 }
                },
                {
                  name: 'cascaded-animation',
                  animation: 'slide-left-animation',
                  nodes: Polymer.dom(this.root).querySelectorAll('.neonElement').reverse(),
                  nodeDelay: 100,
                  timing: { delay: 0 }
                }]

            }
          }
        }
      },

      listeners: {
        'neon-animation-finish' : '_onNeonAnimationFinish'
      },

      neonPlay: function () {
        if (!this.entered) {
          this.entered = true;
          this.buttonSetting = 'neonExit';
          this.isVisible = true;
          this.playAnimation('enter');
        } else {
          this.entered = false;
          this.buttonSetting = 'neonEnter';
          // this.cancelAnimation();
          this.playAnimation('exit');
        }
      },

      _onNeonAnimationFinish: function () {
        if (!this.entered) {
          this.isVisible = false;
          this.neonState = 'Enter';
        } else {
          this.neonState = 'Exit';
        }
      }

    });
  </script>
</dom-module>
